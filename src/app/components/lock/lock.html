<div
  class="fixed inset-0 z-100 flex flex-col items-center justify-center bg-bg p-6 animate-in fade-in duration-500"
>
  <div class="w-full max-w-xs text-center">
    <!-- Icon or Logo -->
    <div class="mb-8 flex justify-center">
      <div
        class="flex h-20 w-20 items-center justify-center rounded-2xl bg-primary shadow-lg shadow-primary/20"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="white"
          class="h-10 w-10"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"
          />
        </svg>
      </div>
    </div>

    <h1 class="mb-2 text-2xl font-bold text-text-main">
      {{ mode === 'unlock' ? 'Unlock Sigil' : step() === 1 ? 'Set PIN' : 'Confirm PIN' }}
    </h1>
    <p class="mb-10 text-text-secondary">
      {{
        mode === 'unlock'
          ? 'Enter your 6-digit PIN to continue'
          : step() === 1
            ? 'Choose a 6-digit PIN for security'
            : 'Enter the PIN again to confirm'
      }}
    </p>

    <!-- PIN Display -->
    <div class="mb-12 flex justify-center gap-3" [class.animate-shake]="error()">
      @for (i of [0, 1, 2, 3, 4, 5]; track i) {
        <div
          class="h-4 w-4 rounded-full border-2 transition-all duration-200"
          [class.bg-text-main]="pin().length > i"
          [class.border-text-main]="pin().length > i"
          [class.border-border]="pin().length <= i"
          [class.border-danger]="error()"
        ></div>
      }
    </div>

    <!-- Error Message -->
    @if (error()) {
      <div class="mb-4 text-sm font-medium text-danger animate-in fade-in slide-in-from-top-1">
        {{ mode === 'unlock' ? 'Incorrect PIN, please try again' : 'PINs do not match, try again' }}
      </div>
    }

    <!-- Keypad -->
    <div class="grid grid-cols-3 gap-4">
      @for (key of keys; track key) {
        <button
          (click)="
            key === 'delete'
              ? handleDelete()
              : key === 'biometric'
                ? handleBiometric()
                : key !== '' && handleKey(key)
          "
          class="flex h-16 w-16 items-center justify-center rounded-full text-xl font-medium transition-all active:scale-95 active:bg-surface"
          [class.invisible]="key === ''"
          [class.text-text-main]="key !== 'delete' && key !== 'biometric'"
          [class.text-primary]="key === 'biometric'"
          [class.text-text-secondary]="key === 'delete'"
          [class.hover:bg-surface]="key !== ''"
        >
          @if (key !== 'delete' && key !== 'biometric') {
            <ng-container>{{ key }}</ng-container>
          }
          @if (key === 'biometric') {
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M12 10a2 2 0 0 0-2 2" />
              <path d="M7 10.1a5 5 0 0 1 7-3.9" />
              <path d="M22 10.3a10 10 0 0 0-15-5.4" />
              <path d="M2 13.1a10 10 0 0 1 15-5.5" />
              <path d="M14 13.1a5 5 0 0 1-7 3.9" />
              <path d="M12 22a2 2 0 0 1-2-2" />
              <path d="M17 21.3a10 10 0 0 1-15-5.4" />
              <path d="M22 13.1a10 10 0 0 0-15 5.5" />
            </svg>
          }
          @if (key === 'delete') {
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 9.75 14.25 12m0 0 2.25 2.25M14.25 12l2.25-2.25M14.25 12L12 14.25m-2.58 4.92-6.374-6.375a1.125 1.125 0 0 1 0-1.59L9.42 4.83c.21-.211.497-.33.795-.33H19.5a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25h-9.284c-.298 0-.585-.119-.795-.33Z"
              />
            </svg>
          }
        </button>
      }
    </div>
  </div>
</div>
